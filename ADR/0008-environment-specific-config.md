# ADR 0008: 環境固有の設定管理

## ステータス
採用

## コンテキスト
アプリケーションをローカル開発環境からAWS本番環境へデプロイすることを見据え、環境ごとに異なるデータベース接続情報やその他の設定を管理する方法が必要となった。

## 決定事項
Spring Bootのプロファイル機能を使用して、環境固有の設定を管理する。具体的には以下の環境を定義:

1. **ローカル環境（local）**: 開発者のマシンで実行する際の設定
2. **本番環境（prod）**: AWS上でのデプロイ時の設定
3. **テスト環境（test）**: 自動テスト実行時の設定

設定ファイルは以下のように構成:

- **application.properties**: 共通設定
- **application-local.properties**: ローカル環境固有設定
- **application-prod.properties**: 本番環境固有設定
- **application-test.properties**: テスト環境固有設定

本番環境の設定値は環境変数から取得する仕組みを実装。

## 根拠
- **環境分離**: 各環境に適した設定を適用できる。
- **セキュリティ向上**: 本番環境の認証情報をコードにハードコードせず、環境変数として管理可能。
- **柔軟性**: 開発者は環境変数を変更せずにローカル環境で開発可能。
- **CDK対応**: AWS CDKでのデプロイ時に適切な環境変数を設定可能。
- **テスト容易性**: テスト実行時に専用の設定（H2データベースなど）を適用可能。

## 影響
- プロファイルに応じた設定ファイルをすべて管理する必要がある。
- 本番環境では適切な環境変数の設定が必須。
- 開発者は使用中のプロファイルを理解し、適切に切り替える必要がある。
- コンテナ化する際はプロファイルと環境変数の設定方法を考慮する必要がある。

## 備考
今後、さらに環境が増えた場合（ステージング環境など）も、同様のアプローチでプロファイルを追加できる。また、プロファイルに依存しない共通設定は引き続きapplication.propertiesに記述する。