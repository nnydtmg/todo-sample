# ADR 0005: テスト戦略

## ステータス
採用

## コンテキスト
アプリケーションの品質を保証するためのテスト戦略を決定する必要があった。

## 決定事項
以下の3層でのテストアプローチを採用:

**バックエンド:**
1. **リポジトリ層テスト**: データアクセス処理のテスト
2. **サービス層テスト**: ビジネスロジックのテスト（モックを使用）
3. **コントローラ層テスト**: REST APIエンドポイントのテスト（モックを使用）

**フロントエンド:**
1. **コンポーネントテスト**: 個別UIコンポーネントのレンダリングと機能テスト
2. **カスタムフックテスト**: ビジネスロジックとAPIインタラクションのテスト
3. **サービス層テスト**: API通信層のテスト（axiosモックを使用）

## 根拠
- **分離されたテスト**: 各層を独立してテストすることで、問題箇所の特定が容易になる。
- **テスト実行速度**: サービスとコントローラ層ではモックを使用することで、テスト実行が高速化される。
- **テストの網羅性**: 各層で異なる側面をテストすることで、より完全なカバレッジが可能になる。
- **H2テストデータベース**: バックエンドテスト用にH2インメモリデータベースを使用することで、テストの独立性と速度を確保。
- **React Testing Library**: フロントエンドでは、実際のユーザー操作に近い形でテストを書くことで、より信頼性の高いテストを実現。
- **APIモック**: 依存関係を分離し、テストの安定性を高めるため、外部APIとの通信をモック。

## 影響
- 開発者はモックの使用方法を理解する必要がある。
- テスト用のH2データベースと本番のMySQLの間で、SQLの互換性の問題が生じる可能性がある。
- テストコードの保守が必要。
- フロントエンドでは特にレンダリングのテストが複雑になる場合がある。

## 備考
将来的には、以下のテスト拡張を検討:
- エンドツーエンドテスト（Cypress、Seleniumなど）
- パフォーマンステスト
- セキュリティテスト
- スナップショットテスト（UIコンポーネント）
